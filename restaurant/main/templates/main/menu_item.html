{% extends "main/base.html" %}
{% load static %}

{% block title %}Menu - {{ item_slug|title }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'main/css/menu_item.css' %}">
{% endblock %}

{% block content %}
<section class="menu-section">
  <h1>Item Details</h1>
  <div id="item-container">
    <!-- Item details will be rendered here -->
  </div>

  <br>
    <br>
      <br>

</section>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const itemSlug = "{{ item_slug|lower }}";

    fetch(`/api/menu/${itemSlug}/`)  // <-- this is correct for your endpoint
      .then(response => {
        if (!response.ok) {
          throw new Error("Item not found");
        }
        return response.json();
      })
      .then(data => {
        const container = document.getElementById('item-container');
        const imagePath = `/static/main/img/menu/${data.slug}.png`;

        const card = document.createElement('div');
        card.classList.add('menu-item');

        card.innerHTML = `
        <div class="menu-item-image">
            <img src="${imagePath}" alt="${data.name}">
        </div>
        <div class="menu-item-details">
            <h3>${data.name} <span>$${data.price}</span></h3>
            <p><strong>Category:</strong> ${data.category.name}</p>
            <p>${data.description}</p>
        </div>
        `;



        container.appendChild(card);
      })
      .catch(error => {
        console.error('Error fetching item:', error);
        document.getElementById('item-container').innerHTML = "<p>Item not found or failed to load.</p>";
      });
  });
</script>
{% endblock %}
